import{_ as s,o,c as n,Q as a}from"./chunks/framework.4719a631.js";const h=JSON.parse('{"title":"Events","description":"","frontmatter":{},"headers":[],"relativePath":"docs/strategies/events.md","filePath":"docs/strategies/events.md"}'),e={name:"docs/strategies/events.md"},l=a(`<h1 id="events" tabindex="-1">Events <a class="header-anchor" href="#events" aria-label="Permalink to &quot;Events&quot;">​</a></h1><h2 id="on-open-position-self-order" tabindex="-1">on_open_position(self, order) <a class="header-anchor" href="#on-open-position-self-order" aria-label="Permalink to &quot;on\\_open\\_position(self, order)&quot;">​</a></h2><p>This function is called right after an open-position order is executed. You may use <code>self.position</code> to access the current position&#39;s object.</p><p><strong>see also</strong>: <a href="./api.html#position">position</a></p><h2 id="on-close-position-self-order" tabindex="-1">on_close_position(self, order) <a class="header-anchor" href="#on-close-position-self-order" aria-label="Permalink to &quot;on\\_close\\_position(self, order)&quot;">​</a></h2><p>The position has been closed with the execution of either a stop-loss or a take-profit order.</p><p>To see if the position was closed because of a take-profit or a stop-loss, you can use the <code>order.is_take_profit</code> or <code>order.is_stop_loss</code> properties:</p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">on_close_position</span><span style="color:#E1E4E8;">(self, order):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> order.is_take_profit:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.log(</span><span style="color:#9ECBFF;">&quot;Take-profit closed the position&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">elif</span><span style="color:#E1E4E8;"> order.is_stop_loss:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.log(</span><span style="color:#9ECBFF;">&quot;Stop-loss closed the position&quot;</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">on_close_position</span><span style="color:#24292E;">(self, order):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> order.is_take_profit:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.log(</span><span style="color:#032F62;">&quot;Take-profit closed the position&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">elif</span><span style="color:#24292E;"> order.is_stop_loss:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.log(</span><span style="color:#032F62;">&quot;Stop-loss closed the position&quot;</span><span style="color:#24292E;">)</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>You do not need to worry about canceling the remaining active orders. Jesse takes care of it for you.</p></div><h2 id="on-increased-position-self-order" tabindex="-1">on_increased_position(self, order) <a class="header-anchor" href="#on-increased-position-self-order" aria-label="Permalink to &quot;on\\_increased\\_position(self, order)&quot;">​</a></h2><p>The size of the position has been increased with the execution of an order.</p><p>This event is fired if your strategy is entering positions in more than one point. For Example:</p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">go_long</span><span style="color:#E1E4E8;">(self):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.buy </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> [</span></span>
<span class="line"><span style="color:#E1E4E8;">        (</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">), </span></span>
<span class="line"><span style="color:#E1E4E8;">        (</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">90</span><span style="color:#E1E4E8;">), </span></span>
<span class="line"><span style="color:#E1E4E8;">    ]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">go_long</span><span style="color:#24292E;">(self):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.buy </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">        (</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">), </span></span>
<span class="line"><span style="color:#24292E;">        (</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">90</span><span style="color:#24292E;">), </span></span>
<span class="line"><span style="color:#24292E;">    ]</span></span></code></pre></div><p>Or if you&#39;re updating the <code>self.buy</code>/<code>self.sell</code> inside the <code>update_position</code> method to increase the size of the position after it is already open.</p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">update_position</span><span style="color:#E1E4E8;">(self):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># increase position size if the long</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># position is in more than 2% profit</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.is_long </span><span style="color:#F97583;">and</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.position.pnl_percentage </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.buy </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.position.qty, </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.price</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">update_position</span><span style="color:#24292E;">(self):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># increase position size if the long</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># position is in more than 2% profit</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.is_long </span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.position.pnl_percentage </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.buy </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.position.qty, </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.price</span></span></code></pre></div><h2 id="on-reduced-position-self-order" tabindex="-1">on_reduced_position(self, order) <a class="header-anchor" href="#on-reduced-position-self-order" aria-label="Permalink to &quot;on\\_reduced\\_position(self, order)&quot;">​</a></h2><p>The position has been reduced (but not closed) with the execution of either a stop-loss or a take-profit order.</p><p>Example usage of this would be to move the stop-loss to break even after part of the position has been exited:</p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">go_long</span><span style="color:#E1E4E8;">(self):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.buy </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">100</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># take-profit in two points</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.take_profit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> [</span></span>
<span class="line"><span style="color:#E1E4E8;">        (</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">120</span><span style="color:#E1E4E8;">), </span></span>
<span class="line"><span style="color:#E1E4E8;">        (</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">140</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">on_reduced_position</span><span style="color:#E1E4E8;">(self, order):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.stop_loss </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">100</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">go_long</span><span style="color:#24292E;">(self):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.buy </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">100</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># take-profit in two points</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.take_profit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">        (</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">120</span><span style="color:#24292E;">), </span></span>
<span class="line"><span style="color:#24292E;">        (</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">140</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">on_reduced_position</span><span style="color:#24292E;">(self, order):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.stop_loss </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">100</span></span></code></pre></div><h2 id="on-cancel-self" tabindex="-1">on_cancel(self) <a class="header-anchor" href="#on-cancel-self" aria-label="Permalink to &quot;on_cancel(self)&quot;">​</a></h2><p>This function is called after all active orders have been canceled. An example of usage would be if you are using a custom value that needs to be cleared after each completed trade.</p><h2 id="events-for-communicating-among-strategies" tabindex="-1">Events for communicating among strategies <a class="header-anchor" href="#events-for-communicating-among-strategies" aria-label="Permalink to &quot;Events for communicating among strategies&quot;">​</a></h2><p>In case you&#39;re trading using multiple routes/strategies and need to communicate among them, you can use the following methods to hook into the events of other strategies.</p><p>As a reminder, to share data among strategies, you need to use the <a href="https://docs.jesse.trade/docs/strategies/api.html#shared-vars" target="_blank" rel="noreferrer">self.shared_vars</a> dictionary property.</p><h2 id="on-route-open-position-self-strategy" tabindex="-1">on_route_open_position(self, strategy) <a class="header-anchor" href="#on-route-open-position-self-strategy" aria-label="Permalink to &quot;on\\_route\\_open\\_position(self, strategy)&quot;">​</a></h2><p>This event method is fired right after a position is <strong>opened</strong>. Useful if you want to know when a position is opened in <strong>another strategy</strong>.</p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">on_route_open_position</span><span style="color:#E1E4E8;">(self, strategy):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># example usage: trading BTC-USDT in the current route </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># strategy and wanting to close it as soon as a position </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># is opened in the ETH-USDT route:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.is_open </span><span style="color:#F97583;">and</span><span style="color:#E1E4E8;"> strategy.symbol </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;ETH-USDT&#39;</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.liquidate()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">on_route_open_position</span><span style="color:#24292E;">(self, strategy):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># example usage: trading BTC-USDT in the current route </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># strategy and wanting to close it as soon as a position </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># is opened in the ETH-USDT route:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.is_open </span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> strategy.symbol </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;ETH-USDT&#39;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.liquidate()</span></span></code></pre></div><h2 id="on-route-close-position-self-strategy" tabindex="-1">on_route_close_position(self, strategy) <a class="header-anchor" href="#on-route-close-position-self-strategy" aria-label="Permalink to &quot;on\\_route\\_close\\_position(self, strategy)&quot;">​</a></h2><p>This event method is fired right after a position is <strong>closed</strong>. Useful if you want to know when a position is closed in <strong>another strategy</strong>.</p><p><strong>see also</strong>: <a href="#on-route-open-position-self-strategy">on_route_open_position</a></p><h2 id="on-route-increased-position-self-strategy" tabindex="-1">on_route_increased_position(self, strategy) <a class="header-anchor" href="#on-route-increased-position-self-strategy" aria-label="Permalink to &quot;on\\_route\\_increased\\_position(self, strategy)&quot;">​</a></h2><p>This event method is fired right after a position is <strong>increased</strong> in size. Useful if you want to know when a position is increased in <strong>another strategy</strong>.</p><p><strong>see also</strong>: <a href="#on-route-open-position-self-strategy">on_route_open_position</a></p><h2 id="on-route-reduced-position-self-strategy" tabindex="-1">on_route_reduced_position(self, strategy) <a class="header-anchor" href="#on-route-reduced-position-self-strategy" aria-label="Permalink to &quot;on\\_route\\_reduced\\_position(self, strategy)&quot;">​</a></h2><p>This event method is fired right after a position is <strong>reduced</strong> in size. Useful if you want to know when a position is reduced in <strong>another strategy</strong>.</p><p><strong>see also</strong>: <a href="#on-route-open-position-self-strategy">on_route_open_position</a></p><h2 id="on-route-canceled-self-strategy" tabindex="-1">on_route_canceled(self, strategy) <a class="header-anchor" href="#on-route-canceled-self-strategy" aria-label="Permalink to &quot;on\\_route\\_canceled(self, strategy)&quot;">​</a></h2><p>This event method is fired right after all active entry orders are <strong>canceled</strong>. Useful if you want to know when all active orders are canceled in <strong>another strategy</strong>.</p><p><strong>see also</strong>: <a href="#on-route-open-position-self-strategy">on_route_open_position</a></p>`,39),p=[l];function t(r,c,i,y,E,d){return o(),n("div",null,p)}const u=s(e,[["render",t]]);export{h as __pageData,u as default};
